<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Ürünler</title>
</head>
<body>
    <h1>Ürünler</h1>
    <a href="/admin/products/add">Yeni Ürün Ekle</a><br><br>
    <table>
        <tr>
            <th>Ürün Adı</th>
            <th>Fiyat</th>
            <th>Stok</th>
            <th>İşlemler</th>
            <th>Yorumlar</th>
        </tr>
        <% products.forEach(function(product) { %>
            <tr>
                <td><%= product.name %></td>
                <td><%= product.price %></td>
                <td><%= product.stock %></td>
                <td>
                    <a href="/admin/products/edit/<%= product.id %>">Düzenle</a> | 
                    <a href="/admin/products/delete/<%= product.id %>">Sil</a>
                </td>
                <td>
                    <!-- Yorumları göster -->
                    <ul>
                        <% product.reviews.forEach(function(review) { %>
                            <li>
                                <p><%= review.username %>: <%= review.comment %> 
                                <% if (review.is_admin) { %>
                                    <strong>(Admin Yorumudur)</strong>
                                <% } %>
                                </p>
                                <!-- Yorum düzenleme ve silme işlemleri -->
                                <a href="/admin/products/review/edit/<%= review.id %>">Düzenle</a> | 
                                <a href="/admin/products/review/delete/<%= review.id %>">Sil</a>
                            </li>
                        <% }); %>
                    </ul>
                    <!-- Yeni yorum ekleme formu -->
                    <form action="/admin/products/review/add/<%= product.id %>" method="POST">
                        <label for="rating">Puan:</label>
                        <input type="number" id="rating" name="rating" min="1" max="5" required><br>
                        <label for="comment">Yorum:</label>
                        <textarea id="comment" name="comment" required></textarea><br>
                        <button type="submit">Yorum Yap</button>
                    </form>
                </td>
            </tr>
        <% }); %>
    </table>
</body>
</html>
